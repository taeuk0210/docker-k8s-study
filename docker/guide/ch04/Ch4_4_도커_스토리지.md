# ğŸ“˜ Chapter 4.4 ë„ì»¤ ìŠ¤í† ë¦¬ì§€

## ğŸ“Œ í•™ìŠµ ëª©í‘œ

- ë„ì»¤ ìŠ¤í† ë¦¬ì§€ ì§€ì‹ ìŠµë“
- postgres í™œìš©í•œ ì‹¤ìŠµ

## ğŸ” í•™ìŠµ ë‚´ìš©

### ğŸ”¸ 4.4.1 ë„ì»¤ ìŠ¤í† ë¦¬ì§€ ê°œë…

ë„ì»¤ ì»¨í…Œì´ë„ˆê°€ ì‚­ì œë˜ë©´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ ì¡´ì¬í•˜ëŠ” íŒŒì¼ë„ ì‚­ì œëœë‹¤.  
ë”°ë¼ì„œ ì»¨í…Œì´ë„ˆì— ì‹¤í–‰ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ë°ì´í„°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ë„ì»¤ ìŠ¤í† ë¦¬ì§€!

ë„ì»¤ ìŠ¤í† ë¦¬ì§€ ì¢…ë¥˜

- **bind mount** : ë„ì»¤ í˜¸ìŠ¤íŠ¸ ë””ë ‰í† ë¦¬ë¥¼ ì§ì ‘ ê³µìœ í•˜ëŠ” ë°©ì‹
- **volume** : ë„ì»¤ë¥¼ í™œìš©í•´ ë³¼ë¥¨ì„ ìƒì„±í•œ í›„ ì»¨í…Œì´ë„ˆì˜ ë””ë ‰í„°ë¦¬ì™€ ê³µìœ í•˜ëŠ” ë°©ì‹
- **tmpfs** : ë„ì»¤ í˜¸ìŠ¤íŠ¸ ë©”ëª¨ë¦¬ì— íŒŒì¼ì´ ì €ì¥ë˜ëŠ” ë°©ì‹(ì¼ì‹œì )

### ğŸ”¸ 4.4.3 volume

```bash
# 1. volume ìƒì„±
docker volume create my-volume-ch04

# 2. postgre ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹¤í–‰(ë³¼ë¥¨ì— ì—°ë™í•´ì„œ ìƒì„±!)
docker container run -e POSTGRES_PASSWORD=123321 --mount type=volume,source=my-volume-ch04,target=/var/lib/postgresql/d
ata -d postgres

# 3. ìƒì„±ëœ ì»¨í…Œì´ë„ˆì— ì ‘ì†í•´ì„œ ìœ ì € ìƒì„± í›„ í™•ì¸
docker container exec -it 5e991478ff6315a /bin/bash

psql -U postgres

CREATE USER user01 PASSWORD '1234' SUPERUSER;

\du # ëª©ë¡ í™•ì¸ ëª…ë ¹ì–´
\q # ë‚˜ê°€ê¸°
exit # ì—°ê²° ì¢…ë£Œ

# 4. ì»¨í…Œì´ë„ˆ ì •ì§€ í›„ ì‚­ì œ
docker container stop 5e991478ff63
docker container rm 5e991478ff63

# 5. ì»¨í…Œì´ë„ˆ ìƒˆë¡œ ìƒì„± í›„ ì ‘ì†í•´ì„œ ìœ ì € í™•ì¸
docker container run -e POSTGRES_PASSWORD=123321 -v my-volume-ch04:/var/lib/postgresql/data -d postgres

docker container exec -it f2b98b7671570 /bin/bash

psql -U postgres

\du
\q
exit

# 6. ë³¼ë¥¨ì— dataê°€ ë‹¤ ë“¤ì–´ìˆëŠ”ì§€ í™•ì¸
docker run -it --rm -v my-volume-ch04:/data alpine sh
cd data
ls
```

### ğŸ”¸ 4.4.4 bind mount

```bash
# 1. test01.txt íŒŒì¼ ìˆë˜ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd work/ch04/

#2. postgres ì»¨í…Œì´ë„ˆ ì‹¤í–‰ í›„ ì ‘ì†
docker container run -e POSTGRES_PASSWORD=123321 --mount type=bind,source=/mnt/c/Users/Taeuk/work/ch04,target=/work -d postgres

docker container exec -it 260c11103d9 /bin/bash

# 3. work ë””ë ‰í„°ë¦¬ í™•ì¸
cd work
ls

# 4. ë””ë ‰í„°ë¦¬ ìƒì„± í›„ í™•ì¸í•˜ë©´ í˜¸ìŠ¤íŠ¸ì—ë„ ìƒì„±ë˜ì–´ ìˆìŒ
mkdir test_dir
ls

# 5. ì§€ìš°ëŠ”ê²ƒë„ ë§ˆì°¬ê°€ì§€
rm -rf test_dir
ls
```

### ğŸ”¸ 4.4.3 tmpfs mount

```bash
# 1. postgres ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker container run -e POSTGRES_PASSWORD=12321 --mount type=tmpfs,destination=/var/lib/postgresql/data -d postgres

# 2. ì»¨í…Œì´ë„ˆ ì •ë³´ í™•ì¸
docker inspect COTAINER_ID --format ''

# ì¶œë ¥ ì˜ˆì‹œ
[
    {
        ...

        "Mounts": [
            {
                "Type": "tmpfs",
                "Source": "",
                "Destination": "/var/lib/postgresql/data",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],

        ...

    }
]
```
